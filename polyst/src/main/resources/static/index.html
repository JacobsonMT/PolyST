<!DOCTYPE html>
<html>
<head>
    <title>React + Spring</title>
</head>
<body>
<div id='root'></div>

<script src="https://fb.me/react-15.0.1.js"></script>
<script src="https://fb.me/react-dom-15.0.1.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<script type="text/babel">

    const Base = React.createClass({
        render: function () {
            let columns = [];
            this.props.base.conservation.forEach(function (conservation) {
                columns.push(<td>{conservation}</td>);
            });

            return (
                    <tr>
                        <td>{this.props.base.reference}</td>
                        <td>{this.props.base.cover}</td>
                        <td>{this.props.base.iupPrediction}</td>
                        {columns}
                    </tr>);
        }
    });
    const ProteinTable = React.createClass({
        render: function() {
            let rows = [];
            console.log(this.props);
            this.props.protein.sequence.forEach(function(base) {
                rows.push(<Base base={base} />);
            });
            return (
                    <div className="container">
                        <table className="table table-striped">
                            <thead>
                            <tr>
                                <th>Reference</th>
                                <th>Cover</th>
                                <th>IUP Prediction</th>
                            </tr>
                            </thead>
                            <tbody>{rows}</tbody>
                        </table>
                    </div>);
        }
    });

    const App = React.createClass({

        loadProteinFromServer: function () {
            const self = this;
            $.ajax({
                url: "http://localhost:8080/testProteins"
            }).then(function (data) {
                console.log(data);
                self.setState({protein: data[0]});
            });
        },

        getInitialState: function () {
            return {protein: {sequence:[]}};
        },

        componentDidMount: function () {
            console.log("componentDidMount");
            this.loadProteinFromServer();
        },

        render() {

            return ( <ProteinTable protein={this.state.protein}/> );
        }
    });

    ReactDOM.render(<App />, document.getElementById('root') );
</script>
</body>
</html>